<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>The Config Instance | WMI Scripting</title>
    <meta name="description" content="WMI Scripting and Querying made easy.">
    <link rel="icon" href="/wmi-scripting/wmi-squares.png">
    
    <link rel="preload" href="/wmi-scripting/assets/css/0.styles.69febe6e.css" as="style"><link rel="preload" href="/wmi-scripting/assets/js/app.fbd390b3.js" as="script"><link rel="preload" href="/wmi-scripting/assets/js/3.30bc9dac.js" as="script"><link rel="preload" href="/wmi-scripting/assets/js/2.bbe9884b.js" as="script"><link rel="preload" href="/wmi-scripting/assets/js/7.7458681b.js" as="script"><link rel="prefetch" href="/wmi-scripting/assets/js/10.26623230.js"><link rel="prefetch" href="/wmi-scripting/assets/js/11.045108de.js"><link rel="prefetch" href="/wmi-scripting/assets/js/12.6a6b2ef0.js"><link rel="prefetch" href="/wmi-scripting/assets/js/4.b2559bf1.js"><link rel="prefetch" href="/wmi-scripting/assets/js/5.4bd79ff2.js"><link rel="prefetch" href="/wmi-scripting/assets/js/6.5ba71b34.js"><link rel="prefetch" href="/wmi-scripting/assets/js/8.25d2004c.js"><link rel="prefetch" href="/wmi-scripting/assets/js/9.2d3c2ea0.js">
    <link rel="stylesheet" href="/wmi-scripting/assets/css/0.styles.69febe6e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wmi-scripting/" class="home-link router-link-active"><img src="/wmi-scripting/wmi-squares.svg" alt="WMI Scripting" class="logo"> <span class="site-name can-hide">WMI Scripting</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/wmi-scripting/" class="nav-link">Home</a></div><div class="nav-item"><a href="/wmi-scripting/documentation/" class="nav-link router-link-active">Documentation</a></div><div class="nav-item"><a href="https://github.com/phpwintools/wmi-scripting" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/wmi-scripting/" class="nav-link">Home</a></div><div class="nav-item"><a href="/wmi-scripting/documentation/" class="nav-link router-link-active">Documentation</a></div><div class="nav-item"><a href="https://github.com/phpwintools/wmi-scripting" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Quick Start</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wmi-scripting/documentation/" class="sidebar-link">How It Works</a></li><li><a href="/wmi-scripting/documentation/getting-started.html" class="sidebar-link">Getting Started</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Digging Deeper</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wmi-scripting/documentation/digging-deeper/" class="sidebar-link">Introduction</a></li><li><a href="/wmi-scripting/documentation/digging-deeper/win32-model.html" class="sidebar-link">Win32Model</a></li><li><a href="/wmi-scripting/documentation/digging-deeper/the-config-instance.html" class="active sidebar-link">The Config Instance</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wmi-scripting/documentation/digging-deeper/the-config-instance.html#defaults" class="sidebar-link">Defaults</a></li><li class="sidebar-sub-header"><a href="/wmi-scripting/documentation/digging-deeper/the-config-instance.html#config-methods" class="sidebar-link">Config Methods</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wmi-scripting/documentation/digging-deeper/the-config-instance.html#instance" class="sidebar-link">instance</a></li><li class="sidebar-sub-header"><a href="/wmi-scripting/documentation/digging-deeper/the-config-instance.html#newinstance" class="sidebar-link">newInstance</a></li><li class="sidebar-sub-header"><a href="/wmi-scripting/documentation/digging-deeper/the-config-instance.html#getconnection" class="sidebar-link">getConnection</a></li><li class="sidebar-sub-header"><a href="/wmi-scripting/documentation/digging-deeper/the-config-instance.html#addconnection" class="sidebar-link">addConnection</a></li><li class="sidebar-sub-header"><a href="/wmi-scripting/documentation/digging-deeper/the-config-instance.html#setdefaultconnection" class="sidebar-link">setDefaultConnection</a></li><li class="sidebar-sub-header"><a href="/wmi-scripting/documentation/digging-deeper/the-config-instance.html#getdefaultconnectionname" class="sidebar-link">getDefaultConnectionName</a></li><li class="sidebar-sub-header"><a href="/wmi-scripting/documentation/digging-deeper/the-config-instance.html#getdefaultconnection" class="sidebar-link">getDefaultConnection</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="the-config-instance"><a href="#the-config-instance" aria-hidden="true" class="header-anchor">#</a> The Config Instance</h1> <p>The configuration instance, <code>Config</code>, is the core of this library. Upon instantiation of a model or the <code>Scripting</code>
object an instance of <code>Config</code> will be created.</p> <p><code>Config</code> uses a singleton-like pattern to make directly querying on a model possible.
Due to the usage of this pattern, you typically would not <code>new</code> the <code>Config</code> object directly. However, if you feel
you need to access the <code>Config</code> directly you should do so using the <code>::instance()</code> static method.</p> <h2 id="defaults"><a href="#defaults" aria-hidden="true" class="header-anchor">#</a> Defaults</h2> <p>The only default setting that I'm currently outlining are the connections. If not defined, the default connection is
the machine that is currently running PHP.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code>config<span class="token operator">/</span>connections<span class="token punctuation">.</span>php

<span class="token keyword">return</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'default'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'local'</span><span class="token punctuation">,</span>

    <span class="token single-quoted-string string">'servers'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'local'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'server'</span>          <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'.'</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'namespace'</span>       <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'Root\CIMv2'</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'user'</span>            <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token constant">null</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'password'</span>        <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token constant">null</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'locale'</span>          <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token constant">null</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'authority'</span>       <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token constant">null</span><span class="token punctuation">,</span>
            <span class="token single-quoted-string string">'security_flags'</span>  <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token constant">null</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>If you would like to define a list of connections from a file or array you should construct the array and
instantiate <code>Config</code> as follows:</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$connections</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token single-quoted-string string">'wmi'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'connections'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'default'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'computer-two'</span><span class="token punctuation">,</span>

            <span class="token single-quoted-string string">'servers'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                <span class="token single-quoted-string string">'computer-one'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                    <span class="token single-quoted-string string">'server'</span>          <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'computer1'</span><span class="token punctuation">,</span>
                    <span class="token single-quoted-string string">'user'</span>            <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'admin'</span><span class="token punctuation">,</span>
                    <span class="token single-quoted-string string">'password'</span>        <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'password'</span><span class="token punctuation">,</span>
                    <span class="token comment">// All options below are optional.</span>
                    <span class="token single-quoted-string string">'namespace'</span>       <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token constant">null</span><span class="token punctuation">,</span>
                    <span class="token single-quoted-string string">'locale'</span>          <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token constant">null</span><span class="token punctuation">,</span>
                    <span class="token single-quoted-string string">'authority'</span>       <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token constant">null</span><span class="token punctuation">,</span>
                    <span class="token single-quoted-string string">'security_flags'</span>  <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token constant">null</span><span class="token punctuation">,</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>

                <span class="token single-quoted-string string">'computer-two'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
                    <span class="token single-quoted-string string">'server'</span>          <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'computer2'</span><span class="token punctuation">,</span>
                    <span class="token single-quoted-string string">'user'</span>            <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'admin'</span><span class="token punctuation">,</span>
                    <span class="token single-quoted-string string">'password'</span>        <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'password'</span><span class="token punctuation">,</span>
                    <span class="token single-quoted-string string">'locale'</span>          <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token constant">null</span><span class="token punctuation">,</span>
                    <span class="token single-quoted-string string">'authority'</span>       <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token constant">null</span><span class="token punctuation">,</span>
                    <span class="token single-quoted-string string">'security_flags'</span>  <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token constant">null</span><span class="token punctuation">,</span>
                <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

Config<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">instance</span><span class="token punctuation">(</span><span class="token variable">$connections</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// or</span>
<span class="token keyword">new</span> <span class="token class-name">Config</span><span class="token punctuation">(</span><span class="token variable">$connections</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><p>Either method above will instantiate the <code>Config</code> object to be used later. Again, be sure to do this prior to any
calls to <code>Config</code> to assure predictable behavior. If you use <code>Config::instance($connections)</code> the new connections will
simply be merged i to an already started instance, if one exists, or a new instance will be started with the given
configuration.</p> <p>Accessing the configuration object in the following way keeps you from trampling over the current configuration and
allows you to make global changes.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token comment">// This is how the library accesses the Config object.</span>
<span class="token variable">$config</span> <span class="token operator">=</span> Config<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">instance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="config-methods"><a href="#config-methods" aria-hidden="true" class="header-anchor">#</a> Config Methods</h2> <p>While not all of the <code>Config</code> methods are outlined here below are the ones that may be most useful to you.</p> <h3 id="instance"><a href="#instance" aria-hidden="true" class="header-anchor">#</a> instance</h3> <h4 id="config-instance-array-items-resolver-resolver-null"><a href="#config-instance-array-items-resolver-resolver-null" aria-hidden="true" class="header-anchor">#</a> <code>Config::instance(array $items = [], Resolver $resolver = null)</code></h4> <p>If called without any arguments this will either return the currently instantiated instance or return a new instance
with default setting.</p> <p>If called with the <code>$items</code> array set this will merge the given configuration into the currently existing configuration.</p> <p>If called with <code>$resolver</code> set then it will replace the current <code>Resolver</code> instance with the one given. You shouldn't
need to override this, but it could be useful when testing.</p> <h3 id="newinstance"><a href="#newinstance" aria-hidden="true" class="header-anchor">#</a> newInstance</h3> <h4 id="config-newinstance-array-items-resolver-resolver-null"><a href="#config-newinstance-array-items-resolver-resolver-null" aria-hidden="true" class="header-anchor">#</a> <code>Config::newInstance(array $items = [], Resolver $resolver = null)</code></h4> <p>Operates the same as above with the exception that this will always return a brand new instance. This is also useful
when testing to assure that previously set configuration options do not leak into other tests.</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token keyword">class</span> <span class="token class-name">FeatureTest</span> <span class="token keyword">extends</span> <span class="token class-name">TestCase</span>
<span class="token punctuation">{</span>
    <span class="token comment">/** @var Config */</span>
    <span class="token keyword">protected</span> <span class="token variable">$config</span><span class="token punctuation">;</span>

    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function">setUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">config</span> <span class="token operator">=</span> Config<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="getconnection"><a href="#getconnection" aria-hidden="true" class="header-anchor">#</a> getConnection</h3> <h4 id="config-getconnection-string-name-null"><a href="#config-getconnection-string-name-null" aria-hidden="true" class="header-anchor">#</a> <code>$config-&gt;getConnection(string $name = null)</code></h4> <p>Returns a connection from the <code>Config</code> container by name. If <code>$name</code> is not provided or set to <code>'default'</code> then it will
return the default connection.</p> <p>If a connection is not found it will simply return <code>null</code>.</p> <h3 id="addconnection"><a href="#addconnection" aria-hidden="true" class="header-anchor">#</a> addConnection</h3> <h4 id="config-addconnection-string-name-connection-connection"><a href="#config-addconnection-string-name-connection-connection" aria-hidden="true" class="header-anchor">#</a> <code>$config-&gt;addConnection(string $name, Connection $connection)</code></h4> <p>Add a connection to the <code>Config</code> instance.</p> <h3 id="setdefaultconnection"><a href="#setdefaultconnection" aria-hidden="true" class="header-anchor">#</a> setDefaultConnection</h3> <h4 id="config-setdefaultconnection-string-name"><a href="#config-setdefaultconnection-string-name" aria-hidden="true" class="header-anchor">#</a> <code>$config-&gt;setDefaultConnection(string $name)</code></h4> <p>This will set the default connection by its name. If the connection name does not exist then it will throw an
<code>InvalidConnectionException</code>.</p> <h3 id="getdefaultconnectionname"><a href="#getdefaultconnectionname" aria-hidden="true" class="header-anchor">#</a> getDefaultConnectionName</h3> <h4 id="config-getdefaultconnectionname"><a href="#config-getdefaultconnectionname" aria-hidden="true" class="header-anchor">#</a> <code>$config-&gt;getDefaultConnectionName()</code></h4> <p>Returns the currently set default connection name.</p> <h3 id="getdefaultconnection"><a href="#getdefaultconnection" aria-hidden="true" class="header-anchor">#</a> getDefaultConnection</h3> <h4 id="config-getdefaultconnection"><a href="#config-getdefaultconnection" aria-hidden="true" class="header-anchor">#</a> <code>$config-&gt;getDefaultConnection()</code></h4> <p>Returns the currently set default connection.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/wmi-scripting/documentation/digging-deeper/win32-model.html" class="prev">
          Win32Model
        </a></span> <!----></p> <div class="footer" data-v-22968384>
    MIT Licensed - Copyright © 2019-present Joe Springe - This library is not in any way associated with nor endorsed by Microsoft™.
</div></div> </main></div><div class="global-ui"></div></div>
    <script src="/wmi-scripting/assets/js/app.fbd390b3.js" defer></script><script src="/wmi-scripting/assets/js/3.30bc9dac.js" defer></script><script src="/wmi-scripting/assets/js/2.bbe9884b.js" defer></script><script src="/wmi-scripting/assets/js/7.7458681b.js" defer></script>
  </body>
</html>
